// src/asciiGenerator.ts
// ASCII 艺术字生成器 - 将文本转换为大字符

// 简单的 3x5 字体映射 (每个字符 3 宽 5 高)
const FONT_3x5: Record<string, string[]> = {
  A: ["███", "█ █", "███", "█ █", "█ █"],
  B: ["██ ", "█ █", "██ ", "█ █", "██ "],
  C: ["███", "█  ", "█  ", "█  ", "███"],
  D: ["██ ", "█ █", "█ █", "█ █", "██ "],
  E: ["███", "█  ", "██ ", "█  ", "███"],
  F: ["███", "█  ", "██ ", "█  ", "█  "],
  G: ["███", "█  ", "█ █", "█ █", "███"],
  H: ["█ █", "█ █", "███", "█ █", "█ █"],
  I: ["███", " █ ", " █ ", " █ ", "███"],
  J: ["███", "  █", "  █", "█ █", "███"],
  K: ["█ █", "██ ", "█  ", "██ ", "█ █"],
  L: ["█  ", "█  ", "█  ", "█  ", "███"],
  M: ["█ █", "███", "█ █", "█ █", "█ █"],
  N: ["█ █", "███", "███", "█ █", "█ █"],
  O: ["███", "█ █", "█ █", "█ █", "███"],
  P: ["███", "█ █", "███", "█  ", "█  "],
  Q: ["███", "█ █", "█ █", "██ ", " ██"],
  R: ["███", "█ █", "██ ", "█ █", "█ █"],
  S: ["███", "█  ", "███", "  █", "███"],
  T: ["███", " █ ", " █ ", " █ ", " █ "],
  U: ["█ █", "█ █", "█ █", "█ █", "███"],
  V: ["█ █", "█ █", "█ █", "█ █", " █ "],
  W: ["█ █", "█ █", "█ █", "███", "█ █"],
  X: ["█ █", "█ █", " █ ", "█ █", "█ █"],
  Y: ["█ █", "█ █", " █ ", " █ ", " █ "],
  Z: ["███", "  █", " █ ", "█  ", "███"],
  " ": ["   ", "   ", "   ", "   ", "   "],
  "0": ["███", "█ █", "█ █", "█ █", "███"],
  "1": [" █ ", "██ ", " █ ", " █ ", "███"],
  "2": ["███", "  █", "███", "█  ", "███"],
  "3": ["███", "  █", "███", "  █", "███"],
  "4": ["█ █", "█ █", "███", "  █", "  █"],
  "5": ["███", "█  ", "███", "  █", "███"],
  "6": ["███", "█  ", "███", "█ █", "███"],
  "7": ["███", "  █", "  █", "  █", "  █"],
  "8": ["███", "█ █", "███", "█ █", "███"],
  "9": ["███", "█ █", "███", "  █", "███"],
};

// 大型 Block 字体 (6x6)
const FONT_BLOCK: Record<string, string[]> = {
  A: [
    " ████ ",
    "██  ██",
    "██████",
    "██  ██",
    "██  ██",
    "██  ██",
  ],
  B: [
    "█████ ",
    "██  ██",
    "█████ ",
    "██  ██",
    "██  ██",
    "█████ ",
  ],
  C: [
    " ████ ",
    "██  ██",
    "██    ",
    "██    ",
    "██  ██",
    " ████ ",
  ],
  D: [
    "█████ ",
    "██  ██",
    "██  ██",
    "██  ██",
    "██  ██",
    "█████ ",
  ],
  E: [
    "██████",
    "██    ",
    "████  ",
    "██    ",
    "██    ",
    "██████",
  ],
  F: [
    "██████",
    "██    ",
    "████  ",
    "██    ",
    "██    ",
    "██    ",
  ],
  G: [
    " ████ ",
    "██    ",
    "██ ███",
    "██  ██",
    "██  ██",
    " ████ ",
  ],
  H: [
    "██  ██",
    "██  ██",
    "██████",
    "██  ██",
    "██  ██",
    "██  ██",
  ],
  I: [
    "██████",
    "  ██  ",
    "  ██  ",
    "  ██  ",
    "  ██  ",
    "██████",
  ],
  J: [
    "██████",
    "    ██",
    "    ██",
    "    ██",
    "██  ██",
    " ████ ",
  ],
  K: [
    "██  ██",
    "██ ██ ",
    "████  ",
    "██ ██ ",
    "██  ██",
    "██  ██",
  ],
  L: [
    "██    ",
    "██    ",
    "██    ",
    "██    ",
    "██    ",
    "██████",
  ],
  M: [
    "██   ██",
    "███ ███",
    "██ █ ██",
    "██   ██",
    "██   ██",
    "██   ██",
  ],
  N: [
    "██   ██",
    "███  ██",
    "██ █ ██",
    "██  ███",
    "██   ██",
    "██   ██",
  ],
  O: [
    " ████ ",
    "██  ██",
    "██  ██",
    "██  ██",
    "██  ██",
    " ████ ",
  ],
  P: [
    "█████ ",
    "██  ██",
    "█████ ",
    "██    ",
    "██    ",
    "██    ",
  ],
  Q: [
    " ████ ",
    "██  ██",
    "██  ██",
    "██  ██",
    " ████ ",
    "    ██",
  ],
  R: [
    "█████ ",
    "██  ██",
    "█████ ",
    "██ ██ ",
    "██  ██",
    "██  ██",
  ],
  S: [
    " ████ ",
    "██    ",
    " ████ ",
    "    ██",
    "    ██",
    " ████ ",
  ],
  T: [
    "██████",
    "  ██  ",
    "  ██  ",
    "  ██  ",
    "  ██  ",
    "  ██  ",
  ],
  U: [
    "██  ██",
    "██  ██",
    "██  ██",
    "██  ██",
    "██  ██",
    " ████ ",
  ],
  V: [
    "██  ██",
    "██  ██",
    "██  ██",
    "██  ██",
    " ████ ",
    "  ██  ",
  ],
  W: [
    "██   ██",
    "██   ██",
    "██   ██",
    "██ █ ██",
    "███ ███",
    "██   ██",
  ],
  X: [
    "██  ██",
    "██  ██",
    " ████ ",
    " ████ ",
    "██  ██",
    "██  ██",
  ],
  Y: [
    "██  ██",
    "██  ██",
    " ████ ",
    "  ██  ",
    "  ██  ",
    "  ██  ",
  ],
  Z: [
    "██████",
    "   ██ ",
    "  ██  ",
    " ██   ",
    "██    ",
    "██████",
  ],
  " ": [
    "      ",
    "      ",
    "      ",
    "      ",
    "      ",
    "      ",
  ],
};

/**
 * 生成 ASCII 艺术字
 */
export function generateAscii(text: string, style: "simple" | "block" = "block"): string {
  const font = style === "simple" ? FONT_3x5 : FONT_BLOCK;
  const height = style === "simple" ? 5 : 6;
  const upperText = text.toUpperCase();

  const lines: string[] = [];
  for (let row = 0; row < height; row++) {
    let line = "";
    for (const char of upperText) {
      const charArt = font[char] || font[" "];
      line += charArt[row] + " ";
    }
    lines.push(line);
  }

  return lines.join("\n");
}

/**
 * 将普通字符替换为 Unicode 方块字符
 */
export function stylizeAscii(
  ascii: string,
  style: "full" | "light" | "double" = "full"
): string {
  const styles: Record<string, { block: string; half: string }> = {
    full: { block: "█", half: "▓" },
    light: { block: "░", half: "▒" },
    double: { block: "╔", half: "═" },
  };

  const s = styles[style] || styles.full;
  return ascii.replace(/█/g, s.block);
}

/**
 * 添加边框
 */
export function addBorder(ascii: string): string {
  const lines = ascii.split("\n");
  const maxWidth = Math.max(...lines.map((l) => l.length));

  const top = "╔" + "═".repeat(maxWidth + 2) + "╗";
  const bottom = "╚" + "═".repeat(maxWidth + 2) + "╝";

  const bordered = lines.map((line) => {
    const padding = " ".repeat(maxWidth - line.length);
    return "║ " + line + padding + " ║";
  });

  return [top, ...bordered, bottom].join("\n");
}

export default { generateAscii, stylizeAscii, addBorder };
